webpackJsonp([14],{0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg,window.$C.BUILD_NUMBER&&(output+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/build/pages/enterprise")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("routers/ArchiveNew"),__webpack_require__("util/router_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function(ArchiveNew,router_utils){new ArchiveNew;router_utils.start_backbone_history()}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"routers/ArchiveNew":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("routers/Base"),__webpack_require__("models/services/data/vix/Index"),__webpack_require__("models/services/configs/SearchLimit"),__webpack_require__("collections/services/data/vix/Archives"),__webpack_require__("collections/services/data/vix/Providers"),__webpack_require__("collections/services/data/Indexes"),__webpack_require__("views/virtual_indexes/config/ArchiveSetup")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,BaseRouter,IndexModel,LimitsConf,ArchivesCollection,ProvidersCollection,SplunkIndexesCollection,ArchiveSetupView){return BaseRouter.extend({initialize:function(){BaseRouter.prototype.initialize.apply(this,arguments),this.enableAppBar=!1,this.indexModel=new IndexModel,this.providersCollection=new ProvidersCollection,this.splunkIndexes=new SplunkIndexesCollection,this.allArchives=new ArchivesCollection,this.limits=new LimitsConf},page:function(locale,app,page){BaseRouter.prototype.page.apply(this,arguments);var providersDfd=this.providersCollection.fetch();this.splunkIndexes.fetchData.set({count:-1,search:"isInternal=false AND isVirtual=false"},{silent:!0}),this.allArchives.fetchData.set({count:-1},{silent:!0});var splunkIndexesDfd=this.splunkIndexes.fetch(),allArchivesDfd=this.allArchives.fetch(),limitsDfd=this.limits.fetch();this.setPageTitle(_("New Archive").t()),$.when(providersDfd,splunkIndexesDfd,allArchivesDfd,limitsDfd,this.deferreds.pageViewRendered).done(_(function(){this.indexSetup=new ArchiveSetupView({model:{application:this.model.application,limits:this.limits},collection:{providers:this.providersCollection,allArchives:this.allArchives,splunkIndexes:this.splunkIndexes}}),$(".preload").replaceWith(this.pageView.el),this.pageView.$(".main-section-body").append(this.indexSetup.render().el)}).bind(this))}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/virtual_indexes/config/ArchiveSetup":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("require/backbone"),module,__webpack_require__("models/Base"),__webpack_require__("models/virtual_indexes/AddArchive"),__webpack_require__("models/services/data/vix/Index"),__webpack_require__("views/Base"),__webpack_require__("views/shared/controls/ControlGroup"),__webpack_require__("views/shared/controls/MultiInputControl"),__webpack_require__("views/shared/controls/TextControl"),__webpack_require__("views/shared/controls/SyntheticCheckboxControl"),__webpack_require__("views/virtual_indexes/custom_controls/TimeSecondsControl"),__webpack_require__("views/virtual_indexes/custom_controls/OptionalTimeSecondsControl"),__webpack_require__("views/shared/FlashMessages"),__webpack_require__("uri/route"),__webpack_require__("util/string_utils"),__webpack_require__("util/splunkd_utils"),__webpack_require__("shim/splunk.util"),__webpack_require__("views/virtual_indexes/shared.pcss"),__webpack_require__("views/virtual_indexes/config/ArchiveSetup.pcss")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,Backbone,module,BaseModel,AddArchive,IndexModel,BaseView,ControlGroup,MultiInputControl,TextControl,SyntheticCheckboxControl,TimeSecondsControl,OptionalTimeSecondsControl,FlashMessagesView,route,utils,splunkDUtils,splunkUtils,cssShared,css){return BaseView.extend({moduleId:module.id,events:{"click .btn-primary":function(e){if(e.preventDefault(),this.model.addArchive.set({},{validate:!0})){var savedIndexes=[],indexAttrs=this.model.addArchive.generateVixAttributes(),indexCount=indexAttrs.length,failCount=0,indexesDeferred=$.Deferred(),saveDfd=$.Deferred();this.children.unifiedSearchCutoff.isEnabled()&&!this.model.limits.getUnifiedSearch()?(this.model.limits.entry.content.set({unified_search:1}),$.when(this.model.limits.save()).done(_(function(){saveDfd.resolve()}).bind(this))):saveDfd.resolve(),$.when(saveDfd).done(_(function(){_(indexAttrs).each(function(indexAttr){var indexModel=new IndexModel;this.children.flashMessages.register(indexModel),indexModel.entry.content.set(indexAttr),$.when(indexModel.save()).done(function(){savedIndexes.push(indexModel.entry.content.get("vix.output.buckets.from.indexes")),indexCount--,0==indexCount&&indexesDeferred.resolve()}).fail(function(){failCount++,indexCount--,0==indexCount&&indexesDeferred.resolve()})},this)}).bind(this)),$.when(indexesDeferred).done(_(function(){if(failCount>0){var splunkIndexes=this.model.addArchive.get("originIndexes").split(",");splunkIndexes=_(splunkIndexes).difference(savedIndexes),this.model.addArchive.set("originIndexes",splunkIndexes.join(",")),savedIndexes.length>0&&this.children.flashMessages.flashMsgHelper.addGeneralMessage("__INDEXES_SAVED__",{type:splunkDUtils.INFO,html:_("Successfully saved archived indexes for these splunk indexes: "+savedIndexes.join(", ")).t()})}else window.location.href=this._getVirtualIndexesRoute()}).bind(this))}},"click .cancel":function(e){e.preventDefault(),window.location.href=this._getVirtualIndexesRoute()}},initialize:function(){BaseView.prototype.initialize.apply(this,arguments),this.model.addArchive=new AddArchive,this.createIndexesAutoComplete(),this.children.flashMessages=new FlashMessagesView({model:this.model.addArchive}),this.originIndexControl=new MultiInputControl({modelAttribute:"originIndexes",model:this.model.addArchive,autoCompleteFields:this.indexesAutoComplete}),this.children.originIndex=new ControlGroup({className:"index-origin control-group",controlClass:"controls-block",controls:[this.originIndexControl],label:_("Splunk Index(es)").t(),tooltip:_("You can add multiple Splunk Enterprise indexes, separated by commas").t()}),this.children.suffix=new ControlGroup({className:"index-name control-group",controlClass:"controls-block",controlType:"Text",controlOptions:{modelAttribute:"suffix",model:this.model.addArchive},label:_("Archived Index Name Suffix").t(),tooltip:_('The suffix that is appended to each index name, for example "_archive"').t()}),this.providerNames=this.collection.providers.map(function(model){return{label:model.entry.get("name"),value:model.entry.get("name")}}),this.children.provider=new ControlGroup({className:"index-provider control-group",controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{modelAttribute:"provider",model:this.model.addArchive,items:this.providerNames,className:"btn-group view-count",menuWidth:"wide",maxLabelLength:80,toggleClassName:"btn",prompt:_("Select a Provider").t()},label:_("Destination Provider").t()}),this.children.archiveDirectory=new ControlGroup({className:"index-path-hdfs control-group",controlType:"Text",controlClass:"controls-block",controlOptions:{modelAttribute:"outputDirectory",model:this.model.addArchive},label:_("Destination Path in HDFS").t(),help:_("Examples: /home/data/archive/ or hdfs://namenode:8020/user/john/data/").t(),tooltip:_("Root Path where the archived buckets will be stored").t()}),this.timeThresholdControl=new TimeSecondsControl({modelAttribute:"threshold",model:this.model.addArchive}),this.children.timeThreshold=new ControlGroup({className:"control-group",controlClass:"controls-block",controls:[this.timeThresholdControl],label:_("Older Than").t(),tooltip:_("Age at which bucket data should be archived").t()});var helpText=_("Query against virtual index for events older than this value.").t(),docLink=route.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.unifiedsearch.about"),helpLink=' <a href="'+docLink+'" class="doc" target="_blank">'+_("Learn More").t()+' <i class="icon-external"></i></a>';this.children.unifiedSearchCutoff=new OptionalTimeSecondsControl({enabled:!1,modelAttribute:"cutoff",model:this.model.addArchive,checkboxLabel:_("Enable Unified Search").t(),checkboxHelp:_("Unified Search may increase search runtime.").t(),timeLabel:_("Cutoff Time").t(),timeHelp:helpText+helpLink})},createIndexesAutoComplete:function(){var archivedIndexes=[];this.collection.allArchives.each(function(archive){var indexes=archive.entry.content.get("vix.output.buckets.from.indexes");indexes=indexes.split(","),indexes.length>1?archivedIndexes.push(indexes[0]):archivedIndexes=_.union(archivedIndexes,indexes)},this);var indexesAutoComplete=this.collection.splunkIndexes.map(function(index){var name=index.entry.get("name");return{text:name,id:name,disabled:!1}},this);_(archivedIndexes).each(function(archivedIndex){var archiveInAutoComplete=_(indexesAutoComplete).findWhere({id:archivedIndex});if(_(archiveInAutoComplete).isUndefined()){var insertedIndex={text:archivedIndex,id:archivedIndex,disabled:!0},insertPosition=_(indexesAutoComplete).sortedIndex(insertedIndex,"text");indexesAutoComplete.splice(insertPosition,0,insertedIndex)}else archiveInAutoComplete.disabled=!0},this),this.indexesAutoComplete=indexesAutoComplete},managerRoute:function(page,options){return route.manager(this.model.application.get("root"),this.model.application.get("locale"),"system",page,options)},_getVirtualIndexesRoute:function(){return route.manager(this.model.application.get("root"),this.model.application.get("locale"),"system","virtual_indexes",{data:{t:"archives"}})},render:function(){return this.$el.html(this.compiledTemplate({managerRoute:this.managerRoute.bind(this)})),this.children.flashMessages.render().replaceAll(this.$(".flash-messages-placeholder")),this.children.originIndex.render().replaceAll(this.$(".select-indexes-placeholder")),this.children.suffix.render().replaceAll(this.$(".suffix-placeholder")),this.children.provider.render().replaceAll(this.$(".select-provider-placeholder")),this.children.archiveDirectory.render().replaceAll(this.$(".archive-directory-placeholder")),this.children.timeThreshold.render().replaceAll(this.$(".input-age-placeholder")),this.$(".unified-search-cutoff-wrapper").append(this.children.unifiedSearchCutoff.render().el),this},template:'\t                <div class="index-setup section-padded section-header">\t                    <div class="ManagerBar">\t                        <h2 class="ManagerPageTitle section-title">\t                                <%= _("Add Archived Indexes").t() %>\t                        </h2>\t                    <div class="breadcrumb section-description">\t                        <a href="<%- managerRoute("virtual_indexes", {data:{t: "archives"}}) %>"><%= _("Archives").t() %></a>»\t                            <%= _("Add new archived indexes").t() %>\t                    </div>\t                </div>\t                <div class="admin-content dashboard-panel clearfix">\t                    <div class="flash-messages-placeholder"></div>\t                    <div class="select-indexes-placeholder"></div>\t                    <div class="suffix-placeholder"></div>\t                    <div class="select-provider-placeholder"></div>\t                    <div class="archive-directory-placeholder"></div>\t                    <div class="input-age-placeholder"></div>\t                    <div class="unified-search-cutoff-wrapper"></div>\t                    <div class="button-wrapper">\t                        <a href="#" class="btn cancel pull-left"><%- _("Cancel").t() %></a>\t                        <a href="#" class="btn btn-primary pull-right"><%- _("Save").t() %></a>\t                    </div>\t                </div>\t            </div>'})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"models/virtual_indexes/AddArchive":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,BaseModel,splunkUtils){return BaseModel.extend({defaults:{originIndexes:void 0,suffix:"_archive",provider:void 0,outputDirectory:void 0,threshold:86400},validation:{originIndexes:{required:!0,msg:_("Splunk Indexes is a required field.").t()},suffix:{required:!0,msg:_("Archived Index Name Suffix is a required field.").t()},provider:{required:!0,msg:_("Destination Provider is a required field.").t()},outputDirectory:{required:!0,msg:_("Destination Path in HDFS is a required field.").t()},threshold:{min:1,msg:_("Older Than must be a number.").t()},cutoff:{min:1,msg:_("Cutoff Time must be a number.").t()}},initialize:function(attrs,options){BaseModel.prototype.initialize.call(this,attrs,options)},generateVixAttributes:function(){var originIndexes=this.get("originIndexes"),indexes=originIndexes.split(","),results=[],suffix=this.get("suffix"),outputDirectory=this.get("outputDirectory"),provider=this.get("provider"),threshold=this.get("threshold"),cutoff=this.get("cutoff");return"/"==outputDirectory.charAt(outputDirectory.length-1)&&(outputDirectory=outputDirectory.substr(0,outputDirectory.length-1)),_(indexes).each(function(index){results.push({name:index+suffix,"vix.output.buckets.from.indexes":index,"vix.provider":provider,"vix.output.buckets.path":outputDirectory+"/"+index+suffix,"vix.output.buckets.older.than":threshold,"vix.validate.paths":1,"vix.unified.search.cutoff_sec":cutoff})},this),results}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/virtual_indexes/custom_controls/OptionalTimeSecondsControl":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("require/underscore"),__webpack_require__("models/Base"),__webpack_require__("views/Base"),__webpack_require__("views/shared/controls/Control"),__webpack_require__("views/shared/controls/ControlGroup"),__webpack_require__("views/shared/controls/SyntheticCheckboxControl"),__webpack_require__("views/virtual_indexes/custom_controls/TimeSecondsControl"),module],__WEBPACK_AMD_DEFINE_RESULT__=function(_,BaseModel,BaseView,Control,ControlGroup,SyntheticCheckboxControl,TimeSecondsControl,module){return Control.extend({moduleId:module.id,initialize:function(){this.model.editCutoffSec=new BaseModel({enabled:this.options.enabled}),this.enableUnifiedCheckbox=new SyntheticCheckboxControl({model:this.model.editCutoffSec,modelAttribute:"enabled",label:this.options.checkboxLabel}),this.children.enabledGroup=new ControlGroup({controls:[this.enableUnifiedCheckbox],help:this.options.checkboxHelp}),this.listenTo(this.model.editCutoffSec,"change enabled",this.setTimeThresholdVisibility),this.unifiedSearchCutoffControl=new TimeSecondsControl({modelAttribute:this.options.modelAttribute,model:this.options.model}),this.children.timeCutoff=new ControlGroup({className:"control-group",controlClass:"controls-block",controls:[this.unifiedSearchCutoffControl],label:this.options.timeLabel,tooltip:this.options.timeTooltip,help:this.options.timeHelp})},setTimeThresholdVisibility:function(){this.model.editCutoffSec.get("enabled")?this.children.timeCutoff.enable():this.children.timeCutoff.disable()},isEnabled:function(){return this.model.editCutoffSec.get("enabled")},render:function(){return this.$el.append(this.children.enabledGroup.render().el),this.$el.append(this.children.timeCutoff.render().el),this.setTimeThresholdVisibility(),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/virtual_indexes/config/ArchiveSetup.pcss":function(module,exports,__webpack_require__){var content=__webpack_require__(550);"string"==typeof content&&(content=[[module.id,content,""]]);__webpack_require__(14)(content,{});content.locals&&(module.exports=content.locals)},550:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(),exports.push([module.id,".shared-controls-syntheticcheckboxcontrol label.checkbox{padding:0}.index-recursive .checkbox,.index-recursive .control,.index-recursive .control-label,.index-recursive .controls,.index-whitelist .checkbox,.index-whitelist .control,.index-whitelist .control-label,.index-whitelist .controls{display:inline}.index-recursive .checkbox,.index-whitelist .checkbox{margin-left:1em}.shared-dynamicfields .elements td{padding:5px}.key-text-control-placeholder .shared-controls-textcontrol{float:right}.shared-controls-keyvaluecontrol{margin-bottom:10px}.form-horizontal .control-label{width:300px}.form-horizontal .controls{margin-left:310px}.select2-drop .select2-results .select2-disabled{color:#bbb}.unified-search-cutoff-wrapper{display:inline-block}.unified-search-cutoff-wrapper .control-group .controls{margin-right:2px}.unified-search-cutoff-wrapper .control-group .controls label.checkbox{padding-left:22px}.unified-search-cutoff-wrapper .control-group .controls label.checkbox>.btn{left:0}",""])}});