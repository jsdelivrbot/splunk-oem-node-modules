webpackJsonp([53],{0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg,window.$C.BUILD_NUMBER&&(output+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/build/pages/enterprise")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("routers/ModSetup"),__webpack_require__("util/router_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function(ModSetupRouter,router_utils){new ModSetupRouter;router_utils.start_backbone_history()}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"models/modsetup/AppDependenciesInfo":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_SplunkDBase=__webpack_require__("models/SplunkDBase"),_SplunkDBase2=_interopRequireDefault(_SplunkDBase);exports.default=_SplunkDBase2.default.extend({url:function(){var path="/services/apps/local/"+this.get("bundleId")+"/dependencies";return _splunkd_utils2.default.fullpath(path,{app:this.get("bundleId"),owner:"nobody"})},sync:function(method,model,options){var defaults={url:this.url(),data:{output_mode:"json"}},newOptions=_jquery2.default.extend({},defaults,options);return _SplunkDBase2.default.prototype.sync.call(this,method,model,newOptions)}}),module.exports=exports.default},"views/modsetup/Master":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray2=__webpack_require__(984),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_backbone=__webpack_require__("require/backbone"),_backbone2=_interopRequireDefault(_backbone),_Base=__webpack_require__("views/Base"),_Base2=_interopRequireDefault(_Base),_splunk=__webpack_require__("shim/splunk.util"),_splunk2=_interopRequireDefault(_splunk),_Master=__webpack_require__("views/shared/waitspinner/Master"),_Master2=_interopRequireDefault(_Master),_ModSetup=__webpack_require__("views/modsetup/ModSetup"),_ModSetup2=_interopRequireDefault(_ModSetup),_FlashMessagesLegacy=__webpack_require__("views/shared/FlashMessagesLegacy"),_FlashMessagesLegacy2=_interopRequireDefault(_FlashMessagesLegacy),_FlashMessages=__webpack_require__("collections/shared/FlashMessages"),_FlashMessages2=_interopRequireDefault(_FlashMessages),_ModSetupAppsListDialog=__webpack_require__("views/modsetup/ModSetupAppsListDialog"),_ModSetupAppsListDialog2=_interopRequireDefault(_ModSetupAppsListDialog);__webpack_require__("views/modsetup/Master.pcss"),exports.default=_Base2.default.extend({initialize:function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_Base2.default.prototype.initialize.apply(this,args),this.children.waitSpinner=new _Master2.default,this.collection.flashMessages=new _FlashMessages2.default,this.children.flashMessagesView=new _FlashMessagesLegacy2.default({collection:this.collection.flashMessages}),this.children.setup=[],this.children.waitSpinner.start(),this.children.waitSpinner.$el.hide(),this.compiledSuccessTemplate=_underscore2.default.template(this.successTemplate),this.model.appsModel=new _backbone2.default.Model,this.model.appsModel.set("apps",this.options.configurationManager.apps),this.options.configurationManager.apps.length>1&&(this.children.dialog=new _ModSetupAppsListDialog2.default({configurationManager:this.options.configurationManager,backdrop:"static",keyboard:!1,onHiddenRemove:!0,model:{appsModel:this.model.appsModel}}),this.listenTo(this.children.dialog,"appsSelected",this.createSetupViews))},events:{"click .mod-setup-save":"saveClicked","click .app-tab":"leftTabClicked"},leftTabClicked:function(e){e.preventDefault();var $target=(0,_jquery2.default)(e.currentTarget),type=$target.find("a").data().type;(0,_underscore2.default)(this.children.setup).each(function(child){child.id===type?(child.view.$el.show(),child.view.$el.trigger("setup:viewActive")):child.view.$el.hide()}),this.$el.find(".nav-tabs-left > li").removeClass("active"),$target.addClass("active")},instantiateModSetupView:function(bundleId){var modSetupViewOptions={configuration:this.options.configurationManager.configurations[bundleId],bundleId:bundleId,model:{application:this.model.application},collection:{}};return _underscore2.default.isUndefined(this.options.supportedExtensions)||(modSetupViewOptions.supportedExtensions=this.options.supportedExtensions),new _ModSetup2.default(modSetupViewOptions)},createSetupViews:function(){var _this=this;_underscore2.default.each(this.model.appsModel.get("apps"),function(item){_this.children.setup.push({id:item.value,view:_this.instantiateModSetupView(item.value),appLabel:item.label})}),this.renderSetupViews()},saveClicked:function(e){var _this2=this;e.preventDefault();var errors=this.validateAllForms();if(errors.length>0);else{var deferreds=this.saveAllForms();this.children.waitSpinner.$el.show(),this.$(".mod-setup-save").removeClass("enabled").addClass("disabled"),_jquery2.default.when.apply(_jquery2.default,(0,_toConsumableArray3.default)(deferreds)).then(function(){_jquery2.default.when.apply(_jquery2.default,(0,_toConsumableArray3.default)(_this2.saveIsConfigured())).always(function(){_this2.reloadConfigurations()})}).fail(function(errorsList){_this2.onSaveFailed(errorsList)})}},saveIsConfigured:function(){var _this3=this,deferreds=[];return _underscore2.default.each(this.model.appsModel.get("apps"),function(item){var configuration=_this3.options.configurationManager.configurations[item.value];_splunk2.default.normalizeBoolean(configuration.isConfiguredModel.entry.content.get("is_configured"))||(configuration.isConfiguredModel.entry.content.set("is_configured",!0),deferreds.push(configuration.isConfiguredModel.save({})))}),deferreds},reloadConfigurations:function(){var _this4=this,deferreds=[];_underscore2.default.each(this.model.appsModel.get("apps"),function(item){var configuration=_this4.options.configurationManager.configurations[item.value];deferreds.push(configuration.isConfiguredModel.reloadAppConfigurations())}),_jquery2.default.when.apply(_jquery2.default,deferreds).always(function(){_this4.children.waitSpinner.$el.hide();var redirectUrl=_this4.model.classicurl.get("redirect_override"),validRedirect=redirectUrl&&_underscore2.default.isString(redirectUrl)&&"/"===redirectUrl.charAt(0)&&"\\"!==redirectUrl.charAt(1)&&"/"!==redirectUrl.charAt(1);validRedirect?window.location.href=redirectUrl:_this4.$el.find(".main-section").html(_this4.compiledSuccessTemplate({message:(0,_underscore2.default)("Splunk Web successfully saved your configuration.").t()}))})},onSaveFailed:function(errors){this.children.waitSpinner.$el.hide(),this.$(".mod-setup-save").removeClass("disabled").addClass("enabled"),this.formatErrors(errors),this.collection.flashMessages.reset(),this.collection.flashMessages.add(errors)},formatErrors:function(errors){_underscore2.default.each(errors,function(er){var error=er;error.text&&(error.html=error.text),delete error.text})},validateAllForms:function(){var errors=[];return this.clearErrors(),_underscore2.default.each(this.children.setup,function(item){errors=errors.concat(item.view.validateAllForms())}),errors.length>0&&this.showErrors(),errors},showErrors:function(){var _this5=this;_underscore2.default.each(this.children.setup,function(item){item.view.$el.find(".mod-setup-error-message").length>0&&_this5.$el.find(".nav-tabs-left li."+item.id+" .icon-alert").show()})},clearErrors:function(){this.$el.find(".nav-tabs-left li .icon-alert").hide()},saveAllForms:function(){var deferreds=[];return _underscore2.default.each(this.children.setup,function(item){deferreds.push(item.view.save())}),deferreds},render:function(){return this.$el.html(this.compiledTemplate({})),this.children.waitSpinner.render().appendTo(this.$(".wait-spinner")),this.options.configurationManager.apps.length>1?(this.children.dialog.render().appendTo((0,_jquery2.default)("body")),this.children.dialog.show()):this.createSetupViews(),this.$(".flash-messages-placeholder").append(this.children.flashMessagesView.render().el),this},renderSetupViews:function(){var parentEl=null;this.model.appsModel.get("apps").length>1?(this.$el.find(".main-section").html((0,_underscore2.default)(this.templateWithTabs).template({setups:this.children.setup})),parentEl=this.$el.find(".tab-content")):(this.$el.find(".main-section").html((0,_underscore2.default)(this.templateWithoutTabs).template({setups:this.children.setup})),parentEl=this.$el.find(".mod-setup-content")),_underscore2.default.each(this.children.setup,function(item){item.view.render().$el.appendTo(parentEl),item.view.$el.hide()}),this.children.setup[0].view.$el.show()},template:'\n        <div class="section-header section-padded">\n            <div>\n                <span class="wait-spinner pull-right"></span>\n                <button class="pull-right btn btn-primary mod-setup-save"><%- _("Save configuration").t() %></button>\n            </div>\n            <h3 class="section-title"><%- _("Setup").t() %></h3>\n            <p class="description"><%- _("Provide initial configurations for the app").t() %></p>\n            <div class="flash-messages-placeholder"></div>\n            <div clas="clearfix"></div>\n        </div>\n        <div class="main-section">\n    ',templateWithoutTabs:'<div class="mod-setup-content"></div>',templateWithTabs:'\n        <ul class="nav nav-tabs-left">\n            <% _(setups).each((setup, i) => { %>\n                <li class="<%= i === 0 ? "active" : "" %> app-tab  <%- setup.id %>"</li>\n                    <a href="#" data-toggle="tab" data-type="<%- setup.id %>">                        <%- setup.appLabel %>\n                        <i class="icon-alert" style="display: none"></i>\n                    </a>\n                </li>\n            <% }) %>\n        </ul>\n        <div class="tab-content">\n    ',successTemplate:'<div class="success-section">\n            <div class="success-header">\n                <h3><%- message %></h3>\n            </div>\n        </div>'}),module.exports=exports.default},"views/modsetup/ModSetup":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_Base=__webpack_require__("models/Base"),_Base2=_interopRequireDefault(_Base),_Base3=__webpack_require__("views/Base"),_Base4=_interopRequireDefault(_Base3),_HtmlFormDataBindWithDelegate=__webpack_require__("views/shared/databind/HtmlFormDataBindWithDelegate"),_HtmlFormDataBindWithDelegate2=_interopRequireDefault(_HtmlFormDataBindWithDelegate),_ModHandlersHelper=__webpack_require__("helpers/modsetup/ModHandlersHelper"),_ModHandlersHelper2=_interopRequireDefault(_ModHandlersHelper),_ModSetupDataHelper=__webpack_require__("helpers/modsetup/ModSetupDataHelper"),_ModSetupDataHelper2=_interopRequireDefault(_ModSetupDataHelper);__webpack_require__("views/modsetup/ModSetup.pcss");var PREFIX="setup";exports.default=_Base4.default.extend({initialize:function(options){var _this=this;_Base4.default.prototype.initialize.call(this,options);var modHandlersHelperOptions={};this.options=options||{},this.setupDataHelper=new _ModSetupDataHelper2.default(this.options.bundleId,PREFIX,this.options.configuration.isDMCEnabled),this.tabsConfig=[],this.setupProperties=this.options.configuration.json,this.setupHtml=this.options.configuration.html,this.model.target=new _Base2.default,this.createFormViews(),_underscore2.default.isUndefined(this.options.supportedExtensions)||(modHandlersHelperOptions={supportedExtensions:this.options.supportedExtensions}),this.modHandlers=new _ModHandlersHelper2.default(modHandlersHelperOptions);var $deferred=this.modHandlers.initialize({bundle:this.options.bundleId,path:"/static/app"});_jquery2.default.when($deferred).done(function(){_this.updateViewWithDefaultValues()})},events:{"click a[data-toggle]":"tabClicked","setup:viewActive":"viewActive"},tabClicked:function(e){e.preventDefault();var $target=(0,_jquery2.default)(e.currentTarget),type=$target.data().type,newTabConfig=_underscore2.default.find(this.tabsConfig,function(config){return config.id===type});(0,_underscore2.default)(this.children.form.$el.find(".mod-parent > form")).each(function(child){(0,_jquery2.default)(child).hide()}),this.children.form.$el.find('[section-label="'+newTabConfig.label+'"]').show(),this.$el.find(".nav > li").removeClass("active"),$target.parent().addClass("active")},viewActive:function(){var item=_underscore2.default.find(this.tabsConfig,function(config){var el=(0,_jquery2.default)("li."+config.id+" i");return!!el&&el.is(":visible")});item&&(0,_jquery2.default)("li."+item.id+" a").click()},updateViewWithDefaultValues:function(){var _this2=this;_jquery2.default.when(this.setupDataHelper.manageConfigurations(this.setupProperties,this.setupHtml)).done(function(){_this2.model.target.set(_this2.setupDataHelper.getDefaultValues()),_this2.children.form.registerDelegate(_this2.modHandlers.handler),_this2.children.form.writeFormValues(),_this2.children.form.readFormValues()})},createFormViews:function(){var _this3=this,html=this.options.configuration.html,formElements=(0,_jquery2.default)(html).filter("form");_underscore2.default.each(formElements,function(element,index){var label=(0,_jquery2.default)(element).attr("section-label");label||(label=(0,_underscore2.default)("Section").t()+" "+index);var config={label:label,id:label.replace(/ /g,"_")};_this3.tabsConfig.push(config)}),this.children.form=new _HtmlFormDataBindWithDelegate2.default({className:"tab-pane",model:{application:this.model.application,target:this.model.target},html:html,attributePrefix:PREFIX,entityReference:PREFIX+":"})},showErrors:function(){var _this4=this;_underscore2.default.each(this.tabsConfig,function(item){var tabErrors=_this4.$el.find('[section-label="'+item.label+'"]').find(".mod-setup-error-message");tabErrors.length>0&&_this4.$el.find("li."+item.id+" .icon-alert").show()})},clearErrors:function(){this.$el.find(".main-tabs li .icon-alert").hide()},validateAllForms:function(){var errors=[];return this.clearErrors(),errors=errors.concat(this.children.form.validateForm()),errors.length>0&&this.showErrors(errors),errors},save:function(){return this.children.form.save(),this.setupDataHelper.save(this.model.target.toJSON(),PREFIX)},render:function(){return this.$el.append(this.compiledTemplate({config:this.tabsConfig,useTabs:1!==this.tabsConfig.length,bundleId:this.options.bundleId})),this.children.form.render().$el.appendTo(this.$el.find(".tab-content")),this.children.form.$el.find("form").hide().filter(":first-child").show(),this.$el.find("."+this.tabsConfig[0].id).addClass("active"),this},template:'\n        <div class="content-body">\n            <% if(useTabs) { %>\n            <ul class="nav nav-tabs main-tabs">\n                <% _.each(config, function(item) { %>\n                <li class="<%- item.id %>">\n                    <a href="#<%- item.id %>" data-toggle="tab" data-type="<%- item.id %>">\n                        <%- item.label %>\n                        <i class="icon-alert" style="display: none"></i>\n                    </a>\n                </li>\n                <% }); %>\n            </ul>\n            <% } %>\n            <div class="tab-content">\n            </div>\n        </div>\n        '}),module.exports=exports.default},"views/shared/databind/HtmlFormDataBindWithDelegate":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("require/backbone"),__webpack_require__("util/form_databind"),__webpack_require__("util/form_list_databind"),__webpack_require__("views/shared/databind/HtmlFormDialog")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,Backbone,Databind,DatabindList,HtmlFormDialog){var PARENT='<div class="mod-parent"></div>';return HtmlFormDialog.extend({tag:"div",initialize:function(options){HtmlFormDialog.prototype.initialize.apply(this,arguments),this.delegates=null,options.delegate&&this.registerDelegate(options.delegate)},getForm:function(){return this.$("form")},getFormElement:function(){return this.el.querySelectorAll("form")},registerDelegate:function(delegate){this.delegate=delegate,this.delegate.initialize(this.getFormElement(),{attributePrefix:this.attributePrefix})},validateForm:function(){var errors=[];return this.delegate&&(errors=this.delegate.validate.call(this.delegate,this.getFormElement(),this.model.target.toJSON(),errors),errors.length>0&&this.delegate.showErrors(this.getFormElement())),errors},save:function(){this.delegate&&this.delegate.save.call(this.delegate,this.getFormElement(),this.model.target.toJSON())},change:function(){this.delegate&&this.delegate.change.call(this.delegate,this.getFormElement(),this.model.target.toJSON())},removeIgnoredFieldsFromModel:function(){this.delegate&&_.each(this.delegate.ignoreList,function(item){this.model.target.unset(item)},this)},writeFormValues:function(){var formUpdate=this.model.target.toJSON();DatabindList.applyFormValues(this.getForm(),formUpdate),HtmlFormDialog.prototype.writeFormValues.apply(this,arguments),this.delegate&&(formUpdate=this.delegate.writeFormValues.call(this.delegate,formUpdate)),DatabindList.applyFormValues(this.getForm(),formUpdate),Databind.applyFormValues(this.getForm(),formUpdate)},readFormValues:function(){HtmlFormDialog.prototype.readFormValues.apply(this,arguments);var modelUpdate=this.model.target.toJSON();_(DatabindList.readFormValues(this.getForm())).each(function(value,name){0===name.indexOf(this.attributePrefix)&&(modelUpdate[name]=value||[])}.bind(this)),this.delegate&&(modelUpdate=this.delegate.readFormValues.call(this.delegate,modelUpdate)),this.model.target.set(modelUpdate),this.removeIgnoredFieldsFromModel(),this.change()},renderContentHtml:function(html){this.$el.append(PARENT),this.$el.find(".mod-parent").html(html)}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"util/form_list_databind":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getFormElements(formEl){return(0,_jquery2.default)(formEl).find(CUSTOM_FORM_LIST_ELEMENT_PARENT)}function readFormValues(formEl){var data={};return(0,_underscore2.default)(getFormElements(formEl)).each(function(input){var $input=(0,_jquery2.default)(input),name=$input.attr("name");data[name]=$input.data("value")||[]}),data}function applyFormValues(formEl,data){(0,_underscore2.default)(getFormElements(formEl)).each(function(input){var $input=(0,_jquery2.default)(input),name=$input.attr("name");$input.data("value",data[name]),$input.trigger("data")})}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0}),exports.readFormValues=readFormValues,exports.applyFormValues=applyFormValues;var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),CUSTOM_FORM_LIST_ELEMENT_PARENT="splunk-repeat"},"helpers/modsetup/ModHandlersHelper":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_SplunkFormHandlerBase=__webpack_require__("api/SplunkFormHandlerBase"),_SplunkFormHandlerBase2=_interopRequireDefault(_SplunkFormHandlerBase),_requirejs=__webpack_require__("shim/requirejs"),_requirejs2=_interopRequireDefault(_requirejs),SUPPORTED_EXTENSIONS=["FormHandler.js","FormHandler.css"],ModHandlerHelper=function(){function ModHandlerHelper(options){(0,_classCallCheck3.default)(this,ModHandlerHelper),this.supportedExtensions=options.supportedExtensions||SUPPORTED_EXTENSIONS,this.handler=null}return(0,_createClass3.default)(ModHandlerHelper,[{key:"initialize",value:function(options){return this.bundleId=options.bundle,this.basePath=options.path,this.supportedExtensions=options.supportedExtensions||this.supportedExtensions,this.loadHandlers()}},{key:"getFilePaths",value:function(){var _this=this,paths=[];return _underscore2.default.each(this.supportedExtensions,function(fileName){fileName.endsWith(".css")?paths.push("css!"+_this.basePath+"/"+_this.bundleId+"/setup/"+fileName):paths.push(_this.basePath+"/"+_this.bundleId+"/setup/"+fileName)}),paths}},{key:"loadHandlers",value:function(){var _this2=this,paths=this.getFilePaths(),$dererred=_jquery2.default.Deferred();return(0,_requirejs2.default)(paths,function(Dep){if(Dep){var instance=new Dep;instance instanceof _SplunkFormHandlerBase2.default&&(_this2.handler=instance)}else _this2.handler=new _SplunkFormHandlerBase2.default,$dererred.resolve();$dererred.resolve()},function(){_this2.handler||(_this2.handler=new _SplunkFormHandlerBase2.default,$dererred.resolve())}),$dererred}}]),ModHandlerHelper}();exports.default=ModHandlerHelper,module.exports=exports.default},"api/SplunkFormHandlerBase":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("require/underscore"),__webpack_require__("require/backbone")],__WEBPACK_AMD_DEFINE_RESULT__=function(_,Backbone){var SplunkFormHandlerBase=function(options){this.errors=[],this.ignoreList=[],this.options=options||{}};return _.extend(SplunkFormHandlerBase.prototype,Backbone.Events,{initialize:function(forms,options){this.forms=forms,this.options=options||{},_.each(forms,function(el){el.addEventListener("submit",function(e){e.preventDefault()})})},save:function(forms,data){},change:function(forms,data){},validate:function(forms,data,errors){return this.resetErrors(),errors&&(this.errors=errors),_.each(forms,function(form){this._validateForm(form)},this),errors},_validateForm:function(el){if(!el.checkValidity()){var elements=el.querySelectorAll(":invalid");_.each(elements,function(element){for(var name="",message="",el=element;el;)name||(name=el.attributes.name&&el.attributes.name.value.startsWith(this.options.attributePrefix)?el.attributes.name.value:"",name&&el.dataset.errorMessage&&(message=el.dataset.errorMessage)),el=el.parentElement;_.contains(this.ignoreList,name)||this.addError("error",name,message?message:element.validationMessage)},this)}},readFormValues:function(data){return data},writeFormValues:function(data){return data},destroy:function(){},addError:function(type,name,message){this.errors.push({type:type||"error",html:message,name:name})},markFieldsWithError:function(){_.each(this.errors,function(error){for(var name=error.name,classAdded=!1,currentEl=this.getElementWithName(name),el=currentEl;el;){if(el.classList.contains("control-group")){classAdded=!0,el.classList.add("error");break}if(el=el.parentElement,el&&el.classList.contains("tab-content")){el=currentEl;break}}el&&!classAdded&&el.classList.add("error")},this)},showErrors:function(forms){_.each(this.errors,function(item){var errorEl=document.createElement("div");errorEl.className="mod-setup-error-message",errorEl.innerHTML=item.html;var childEl=this.getElementWithName(item.name);childEl&&childEl.parentNode.appendChild(errorEl)},this),this.markFieldsWithError()},resetErrors:function(){_.each(this.forms,function(el){_.each(el.querySelectorAll(".mod-setup-error-message"),function(item){item.remove()},this),this.errors=[];var elements=el.querySelectorAll("*");_.each(elements,function(element){var el=element;for(element.classList.contains("error")&&element.classList.remove("error");(el=el.parentElement)&&!el.classList.contains("error");)el.classList.remove("error")},this)},this)},addToIgnoreList:function(item){_.contains(this.ignoreList,item)||this.ignoreList.push(item)},removeFromIgnoreList:function(item){var index=this.ignoreList.indexOf(item);index>-1&&this.ignoreList.splice(index,1)},getElementWithName:function(name){for(var i=0;i<this.forms.length;i++){var el=this.forms[i].querySelector('[name="'+name+'"]');if(el)return el}return null}}),_.extend(SplunkFormHandlerBase,{extend:Backbone.View.extend}),SplunkFormHandlerBase}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"helpers/modsetup/ModSetupDataHelper":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_ModSetupTypes=__webpack_require__("helpers/modsetup/managers/ModSetupTypes"),ModSetupDataHelper=function(){function ModSetupDataHelper(bundleId,prefix,isDMCEnabled){var _this=this;(0,_classCallCheck3.default)(this,ModSetupDataHelper),this.bundleId=bundleId,this.prefix=prefix,this.isDMCEnabled=isDMCEnabled,this.typeMap={},_underscore2.default.each(_underscore2.default.keys(_ModSetupTypes.TYPES),function(type){_this.typeMap[_ModSetupTypes.TYPES[type]]=(0,_ModSetupTypes.getHelperForType)(type,_this.isDMCEnabled,_this.bundleId,_this.prefix)})}return(0,_createClass3.default)(ModSetupDataHelper,[{key:"manageConfigurations",value:function(properties,html){var _this2=this,setupProperties=this.constructValidConfiguration(properties,html),fecheDeferred=_jquery2.default.Deferred(),deferreds=[];_underscore2.default.each(setupProperties.setup,function(config){deferreds=deferreds.concat(_this2.create(config))});var count=0;return _underscore2.default.each(deferreds,function(def){def.always(function(){count+=1,count===deferreds.length&&fecheDeferred.resolve()})}),fecheDeferred}},{key:"save",value:function(data){var _this3=this,deferreds=[],errors=[],count=0,saveDeferred=_jquery2.default.Deferred(),handleSaveState=function(){count+=1,count===deferreds.length&&(errors.length>0?saveDeferred.reject(errors):saveDeferred.resolve())};return _underscore2.default.each(_underscore2.default.keys(this.typeMap),function(type){deferreds=deferreds.concat(_this3.typeMap[type].save(data,type))}),_underscore2.default.each(deferreds,function(def){def.fail(function(resp){if(resp.responseText){var parsedResp=JSON.parse(resp.responseText);parsedResp.messages&&(errors=errors.concat(parsedResp.messages))}}).always(function(){handleSaveState()})}),saveDeferred}},{key:"getDefaultValues",value:function(){var defaults={};return _underscore2.default.each(_underscore2.default.values(this.typeMap),function(type){defaults=_underscore2.default.extend({},defaults,type.getDefaultValues())}),defaults}},{key:"setType",value:function(config){var newConfig=config,matchedType=_underscore2.default.intersection(_underscore2.default.keys(newConfig),_underscore2.default.values(_ModSetupTypes.TYPES));if(matchedType.length>0)return newConfig.type=matchedType[0],newConfig;throw new Error("Invalid type")}},{key:"create",value:function(config){var _this4=this,deferreds=[],props=["name","isList"];if(config.isList&&config.types)_underscore2.default.each(_underscore2.default.keys(config.types),function(key){var cfg=_underscore2.default.pick.apply(_underscore2.default,[config].concat(props));cfg[key]=config.types[key],cfg=_this4.setType(cfg),deferreds=deferreds.concat(_this4.typeMap[key].create(cfg))});else{var newConfig=this.setType(config);deferreds=deferreds.concat(this.typeMap[config.type].create(newConfig))}return deferreds}},{key:"constructValidConfiguration",value:function(properties,html){var _this5=this,$el=(0,_jquery2.default)(html),names=[],newProperties={setup:[]};return $el.find("[name]").each(function(index,element){names.push((0,_jquery2.default)(element).attr("name").substr(_this5.prefix.length+1))}),_underscore2.default.each(properties.setup,function(config){_underscore2.default.contains(names,config.name)&&newProperties.setup.push(config)}),newProperties}}]),ModSetupDataHelper}();exports.default=ModSetupDataHelper,module.exports=exports.default},"helpers/modsetup/managers/ModSetupTypes":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getConfigForType(type){return ModSetupTypesConfig[type]}function getTypes(){var MODSETUP_TYPES={};return Object.keys(ModSetupTypesConfig).forEach(function(type){MODSETUP_TYPES[type]=getConfigForType(type).name}),MODSETUP_TYPES}function getHelperForType(type,isDMCEnabled){for(var HelperClass=ModSetupTypesConfig[type].helper,_len=arguments.length,args=Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];return new(Function.prototype.bind.apply(HelperClass,[null].concat(args,[isDMCEnabled])))}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0}),exports.TYPES=void 0,exports.getHelperForType=getHelperForType;var _ModSetupConfType=__webpack_require__("helpers/modsetup/managers/ModSetupConfType"),_ModSetupConfType2=_interopRequireDefault(_ModSetupConfType),_ModSetupPasswordType=__webpack_require__("helpers/modsetup/managers/ModSetupPasswordType"),_ModSetupPasswordType2=_interopRequireDefault(_ModSetupPasswordType),_ModSetupScriptType=__webpack_require__("helpers/modsetup/managers/ModSetupScriptType"),_ModSetupScriptType2=_interopRequireDefault(_ModSetupScriptType),ModSetupTypesConfig={
CONF:{name:"conf",helper:_ModSetupConfType2.default},PASSWORD:{name:"password",helper:_ModSetupPasswordType2.default},SCRIPT:{name:"script",helper:_ModSetupScriptType2.default}};exports.TYPES=getTypes()},"helpers/modsetup/managers/ModSetupConfType":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty2=__webpack_require__(502),_defineProperty3=_interopRequireDefault(_defineProperty2),_toConsumableArray2=__webpack_require__(984),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(830),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(876),_inherits3=_interopRequireDefault(_inherits2),_ModSetupSplunkDConf=__webpack_require__("models/modsetup/ModSetupSplunkDConf"),_ModSetupSplunkDConf2=_interopRequireDefault(_ModSetupSplunkDConf),_ModSetupSplunkDConfs=__webpack_require__("collections/modsetup/ModSetupSplunkDConfs"),_ModSetupSplunkDConfs2=_interopRequireDefault(_ModSetupSplunkDConfs),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_ModSetupBaseType2=__webpack_require__("helpers/modsetup/managers/ModSetupBaseType"),_ModSetupBaseType3=_interopRequireDefault(_ModSetupBaseType2),_ModSetupTypes=__webpack_require__("helpers/modsetup/managers/ModSetupTypes"),GLOBAL_CONFIG_PROPS=["name","isList","viewConfig"],NAME_ATTR="@name",CONFIG_KEY="@config",ModSetupConfType=function(_ModSetupBaseType){function ModSetupConfType(){var _ref;(0,_classCallCheck3.default)(this,ModSetupConfType);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3.default)(this,(_ref=ModSetupConfType.__proto__||Object.getPrototypeOf(ModSetupConfType)).call.apply(_ref,[this].concat(args)));return _this.dataMap={},_this.listMap={},_this}return(0,_inherits3.default)(ModSetupConfType,_ModSetupBaseType),(0,_createClass3.default)(ModSetupConfType,[{key:"getDefaultValues",value:function(){var _this2=this,defaults={},prefix=this.options.prefix||"";return _underscore2.default.each(_underscore2.default.keys(this.dataMap),function(key){if(_this2.dataMap[key]&&_this2.dataMap[key].length>0){var model=_this2.dataMap[key][0],properties=model.get("properties")||[],attrs=_underscore2.default.pick.apply(_underscore2.default,[model.entry.content.toJSON()].concat((0,_toConsumableArray3.default)(properties))),prop=properties[0];attrs[prop]&&(defaults[prefix+"."+key]=attrs[prop])}}),_underscore2.default.each(_underscore2.default.keys(this.listMap),function(key){defaults[_this2.options.prefix+"."+key]=_this2.getDefaultDataForList(_this2.listMap[key])}),defaults}},{key:"getDefaultDataForList",value:function(items){var data={};return _underscore2.default.each(items,function(item){var config=item.config;config.viewConfig&&(data[CONFIG_KEY]=(0,_defineProperty3.default)({},CONFIG_KEY,config.viewConfig)),item.each(function(model){if(!_underscore2.default.isArray(config.stanzas)||_underscore2.default.contains(config.stanzas,model.entry.get("name"))){var properties=model.get("properties")||[],obj=_underscore2.default.pick.apply(_underscore2.default,[model.entry.content.toJSON()].concat((0,_toConsumableArray3.default)(properties))),keyValue=model.entry.get("name");data[keyValue]?data[keyValue]=_underscore2.default.extend({},data[keyValue],obj):(obj[NAME_ATTR]=model.entry.get("name"),data[keyValue]=obj)}})}),_underscore2.default.values(data)}},{key:"create",value:function(config){var _this3=this,deferreds=[],confs=config.conf;return _underscore2.default.each(confs,function(val){var value=val;value=_underscore2.default.extend({},value,_underscore2.default.pick.apply(_underscore2.default,[config].concat(GLOBAL_CONFIG_PROPS))),deferreds=config.isList?deferreds.concat(_this3.handleListConf(value)):deferreds.concat(_this3.handleSingleConf(value))}),deferreds}},{key:"handleListConf",value:function(config){var _this4=this,deferreds=[],item=null;item=new _ModSetupSplunkDConfs2.default,item.config=config,this.constructFetchQuery(item);var def=item.fetch().done(function(){_underscore2.default.each(item.models,function(model){_this4.updateModelProperties(model,config)},_this4),_this4.updateMap(_this4.dataMap,config.name,item.models),_this4.addModelToList(item.models),_this4.updateMap(_this4.listMap,config.name,[item])});return deferreds.push(def),deferreds}},{key:"handleSingleConf",value:function(config){var _this5=this,deferreds=[];if(_underscore2.default.isArray(config.stanzas))_underscore2.default.each(config.stanzas,function(stanza){var item=null;_underscore2.default.isString(stanza)&&(item=new _ModSetupSplunkDConf2.default,_this5.updateModelProperties(item,config),item.entry.set("name",stanza));var def=item.fetch().done(function(){_this5.updateMap(_this5.dataMap,config.name,[item]),_this5.addModelToList([item])});deferreds.push(def)});else if(_underscore2.default.isObject(config.stanzas)&&config.stanzas.pattern){var item=new _ModSetupSplunkDConfs2.default;item.config=config,this.constructFetchQuery(item);var def=item.fetch().done(function(){_underscore2.default.each(item.models,function(model){_this5.updateModelProperties(model,config)},_this5),_this5.updateMap(_this5.dataMap,config.name,item.models),_this5.addModelToList(item.models)});deferreds.push(def)}return deferreds}},{key:"constructFetchQuery",value:function(i){var item=i,config=item.config,query={};item.config.bundleId=this.options.bundleId,query=_underscore2.default.isObject(config.stanzas)&&config.stanzas.pattern?"name="+config.stanzas.pattern:_underscore2.default.isArray(config.stanzas)?config.stanzas.map(function(name){return"name="+name}).join(" OR "):config.stanzas,item.config.query=query}},{key:"updateMap",value:function(m,key,items){var map=m;map[key]?map[key]=map[key].concat(items):map[key]=items}},{key:"updateModelProperties",value:function(model,config){model.set({bundle:this.options.bundleId,type:config.file,key:config.name,properties:config.properties,allProperties:config.properties})}},{key:"addModelToList",value:function(models){var _this6=this;_underscore2.default.each(models,function(model){var baseModel=_this6.findInModelsList(model);baseModel?baseModel.set("allProperties",_underscore2.default.union(baseModel.get("allProperties"),model.get("properties"))):_this6.models.push(model)})}},{key:"save",value:function(data){var _this7=this,deferreds=[];return _underscore2.default.each(_underscore2.default.keys(data),function(key){var content=data[key];_underscore2.default.isString(content)?_this7.saveStringValues(key,data):_underscore2.default.isArray(content)&&(deferreds=deferreds.concat(_this7.saveListValues(key,content)))}),_underscore2.default.each(this.models,function(model){model.dirty&&!model.delete&&deferreds.push(model.save({}))}),deferreds}},{key:"saveStringValues",value:function(key,data){var _this8=this,keyWithoutPrefix=key.substr(this.options.prefix.length+1),models=this.dataMap[keyWithoutPrefix];_underscore2.default.each(models,function(model){var objs=[];_underscore2.default.each(model.get("properties"),function(property){var obj=[property],prop=_this8.options.prefix+"."+model.get("key");prop in data&&(obj.push(data[prop]),objs.push(obj))}),_this8.saveModelWithProperties(model,data,objs)})}},{key:"saveListValues",value:function(key,content){var _this9=this,keyWithoutPrefix=key.substr(this.options.prefix.length+1),deferreds=[],currentNames=_underscore2.default.pluck(content,NAME_ATTR),deleteList=[],allModelds=[],collections=this.listMap[keyWithoutPrefix];return _underscore2.default.each(content,function(item){var models=_this9.findInCollections(collections,item);models&&models.length>0?_underscore2.default.each(models,function(model){var objs=[];_underscore2.default.each(model.get("properties"),function(property){var obj=[property];property in item&&(obj.push(item[property]),objs.push(obj))}),_this9.saveModelWithProperties(model,item,objs)}):_underscore2.default.each(collections,function(collection){var model=new _ModSetupSplunkDConf2.default,objs=[];model.set({bundle:_this9.options.bundleId,type:collection.config.file,name:item[NAME_ATTR]}),model.entry.set("name",item[NAME_ATTR]),_underscore2.default.each(collection.config.properties,function(property){var obj=[property];item[property]&&(obj.push(item[property]),objs.push(obj))}),objs.push([NAME_ATTR,item[NAME_ATTR]]),model.set("allProperties",collection.config.properties),model.entry.content.set(_underscore2.default.object(objs)),deferreds.push(model.save({}))})}),_underscore2.default.each(collections,function(collection){allModelds=allModelds.concat(collection.models)}),deleteList=_underscore2.default.filter(allModelds,function(model){return!_underscore2.default.contains(currentNames,model.entry.get("name"))}),_underscore2.default.each(deleteList,function(model){var baseModel=_this9.findInModelsList(model);baseModel?(baseModel.delete=!0,deferreds.push(baseModel.destroy())):deferreds.push(model.destroy())}),deferreds}},{key:"saveModelWithProperties",value:function(model,data,properties){var baseModel=this.findInModelsList(model);baseModel.entry.content.set(_underscore2.default.object(properties)),baseModel.dirty=!0}},{key:"findInCollections",value:function(collections,item){var models=[];return _underscore2.default.each(collections,function(collection){models=models.concat(collection.filter(function(model){return model.entry.get("name")===item[NAME_ATTR]}))}),models}},{key:"findInModelsList",value:function(model){return _underscore2.default.find(this.models,function(item){return item.entry.get("name")===model.entry.get("name")&&item.get("type")===model.get("type")})}}],[{key:"getType",value:function(){return _ModSetupTypes.TYPES.CONF}}]),ModSetupConfType}(_ModSetupBaseType3.default);exports.default=ModSetupConfType,module.exports=exports.default},"models/modsetup/ModSetupSplunkDConf":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray2=__webpack_require__(984),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_SplunkDBase=__webpack_require__("models/SplunkDBase"),_SplunkDBase2=_interopRequireDefault(_SplunkDBase);exports.default=_SplunkDBase2.default.extend({urlBase:"configs/conf-",url:function(){var path=this.urlBase+this.get("type");return _splunkd_utils2.default.fullpath(path,{app:this.get("bundle"),owner:"nobody"})},sync:function(method,model,options){var defaults={url:this.url(),data:{}};switch(method){case"create":defaults.data.name=this.entry.get("name"),this.updateAllProperties(defaults);break;case"update":defaults.url=defaults.url+"/"+this.entry.get("name"),this.updateAllProperties(defaults);break;case"delete":delete defaults.url;break;default:defaults.url=defaults.url+"/"+this.entry.get("name")}var newOptions=_jquery2.default.extend(!0,defaults,options);return _SplunkDBase2.default.prototype.sync.call(this,method,model,newOptions)},updateAllProperties:function(defaults){this.allProperties=this.get("allProperties")||[],_jquery2.default.extend(!0,defaults.data,_underscore2.default.pick.apply(_underscore2.default,[this.entry.content.toJSON()].concat((0,_toConsumableArray3.default)(this.allProperties))))},reloadAppConfigurations:function(){var url=_splunkd_utils2.default.fullpath("/services/apps/local/"+this.get("bundle")+"/_reload");return _jquery2.default.ajax({url:url,data:{output_mode:"json"}})}}),module.exports=exports.default},"collections/modsetup/ModSetupSplunkDConfs":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_ModSetupSplunkDConf=__webpack_require__("models/modsetup/ModSetupSplunkDConf"),_ModSetupSplunkDConf2=_interopRequireDefault(_ModSetupSplunkDConf),_SplunkDsBase=__webpack_require__("collections/SplunkDsBase"),_SplunkDsBase2=_interopRequireDefault(_SplunkDsBase);exports.default=_SplunkDsBase2.default.extend({urlBase:"configs/conf-",model:_ModSetupSplunkDConf2.default,url:function(){var path=this.urlBase+this.config.file;return _splunkd_utils2.default.fullpath(path,{app:this.config.bundleId,owner:"nobody"})},fetch:function(options){var currentOptions=options;currentOptions=_underscore2.default.defaults(currentOptions||{},{count:0});var defaults={url:this.url(),data:_underscore2.default.defaults(currentOptions.data||{},{count:-1})};this.config.query&&(defaults.data.search=this.config.query);var updatedOptions=_jquery2.default.extend(!0,defaults,currentOptions);return _SplunkDsBase2.default.prototype.fetch.call(this,updatedOptions)}}),module.exports=exports.default},"helpers/modsetup/managers/ModSetupBaseType":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),ModSetupBaseType=function(){function ModSetupBaseType(bundleId,prefix,isDMCEnabled){(0,_classCallCheck3.default)(this,ModSetupBaseType),this.options={bundleId:bundleId,prefix:prefix,isDMCEnabled:isDMCEnabled},this.models=[]}return(0,_createClass3.default)(ModSetupBaseType,[{key:"getDefaultValues",value:function(){}},{key:"create",value:function(){}},{key:"save",value:function(){}}],[{key:"getType",value:function(){return null}}]),ModSetupBaseType}();exports.default=ModSetupBaseType,module.exports=exports.default},"routers/ModSetup":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_Base=__webpack_require__("routers/Base"),_Base2=_interopRequireDefault(_Base),_Master=__webpack_require__("views/modsetup/Master"),_Master2=_interopRequireDefault(_Master),_ModSetupConfigurationManager=__webpack_require__("helpers/modsetup/configuration/ModSetupConfigurationManager"),_ModSetupConfigurationManager2=_interopRequireDefault(_ModSetupConfigurationManager),_classicurl=__webpack_require__("models/classicurl"),_classicurl2=_interopRequireDefault(_classicurl);exports.default=_Base2.default.extend({initialize:function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_Base2.default.prototype.initialize.apply(this,args),this.setPageTitle((0,_underscore2.default)("Mod setup").t()),this.enableAppBar=!1,this.showAppsList=!1,_underscore2.default.isUndefined(args.supportedExtensions)||(this.supportedExtensions=args.supportedExtensions),this.model.classicurl=_classicurl2.default,this.deferreds.classicurl=this.model.classicurl.fetch()},page:function(){for(var _this=this,_len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];_Base2.default.prototype.page.apply(this,args),_jquery2.default.when(this.deferreds.classicurl).then(function(){var editAction=_this.model.classicurl.get("action"),modSetupConfigurationManager=new _ModSetupConfigurationManager2.default({app:_this.model.application.get("app"),isDMCEnabled:!1,isEditAll:editAction&&"edit"===editAction});_jquery2.default.when(modSetupConfigurationManager.fetchConfigAppsList(_this.model.application.get("app"))).done(function(){var masterViewOptions={configurationManager:modSetupConfigurationManager,model:{application:_this.model.application,classicurl:_this.model.classicurl},collection:{}};_underscore2.default.isUndefined(_this.supportedExtensions)||(masterViewOptions.supportedExtensions=_this.supportedExtensions),modSetupConfigurationManager.requiresSetup()&&((0,_jquery2.default)(".preload").replaceWith(_this.pageView.el),_this.masterView=new _Master2.default(masterViewOptions),_this.pageView.$(".main-section-body").append(_this.masterView.render().el))})})}}),module.exports=exports.default},"models/modsetup/ModSetupPassword":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_SplunkDBase=__webpack_require__("models/SplunkDBase"),_SplunkDBase2=_interopRequireDefault(_SplunkDBase);exports.default=_SplunkDBase2.default.extend({url:function(){var path="storage/passwords";return _splunkd_utils2.default.fullpath(path,{app:this.get("bundle"),owner:"nobody"})},sync:function(method,model,options){var defaults={};switch(method){case"create":defaults={data:{output_mode:"json",name:this.entry.get("name")}};break;case"read":defaults={url:this.url()+"/"+this.entry.get("name"),data:{output_mode:"json"}}}var newOptions=_jquery2.default.extend({},defaults,options);return _SplunkDBase2.default.prototype.sync.call(this,method,model,newOptions)}}),module.exports=exports.default},"helpers/modsetup/managers/ModSetupScriptType":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(830),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(876),_inherits3=_interopRequireDefault(_inherits2),_ModSetupScripts=__webpack_require__("collections/modsetup/ModSetupScripts"),_ModSetupScripts2=_interopRequireDefault(_ModSetupScripts),_ModSetupScript=__webpack_require__("models/modsetup/ModSetupScript"),_ModSetupScript2=_interopRequireDefault(_ModSetupScript),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_ModSetupBaseType2=__webpack_require__("helpers/modsetup/managers/ModSetupBaseType"),_ModSetupBaseType3=_interopRequireDefault(_ModSetupBaseType2),_ModSetupTypes=__webpack_require__("helpers/modsetup/managers/ModSetupTypes"),NAME_ATTR="@name",ModSetupScriptType=function(_ModSetupBaseType){function ModSetupScriptType(){var _ref;(0,_classCallCheck3.default)(this,ModSetupScriptType);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=(0,_possibleConstructorReturn3.default)(this,(_ref=ModSetupScriptType.__proto__||Object.getPrototypeOf(ModSetupScriptType)).call.apply(_ref,[this].concat(args)));return _this.collectionsMap={},_this}return(0,_inherits3.default)(ModSetupScriptType,_ModSetupBaseType),(0,_createClass3.default)(ModSetupScriptType,[{key:"getDefaultValues",value:function(){var _this2=this,defaults={};return _underscore2.default.each(_underscore2.default.values(this.collectionsMap),function(collection){_underscore2.default.each(collection.models,function(model){var attrs=model.entry.content.toJSON();attrs[NAME_ATTR]=model.entry.get("name");var prop=_this2.options.prefix+"."+model.get("key");defaults[prop]?defaults[prop].push(attrs):defaults[prop]=[attrs]})}),defaults}},{key:"create",value:function(data){var deferreds=[],collection=new _ModSetupScripts2.default;collection.bundleId=this.options.bundleId,collection.scriptUrl=data.script.url;var def=collection.fetch({}).done(function(){_underscore2.default.each(collection.models,function(model){model.set({key:data.name})})});return this.collectionsMap[data.name]=collection,deferreds.push(def),deferreds}},{key:"addNew",value:function(collection,data){var model=new _ModSetupScript2.default;model.entry.set("name",data["@name"]);var obj=_jquery2.default.extend(!0,{},data);return model.bundleId=this.options.bundleId,model.scriptUrl=collection.scriptUrl,delete obj["@name"],model.entry.content.set(obj),model}},{key:"save",value:function(data){var _this3=this,deferreds=[];return _underscore2.default.each(_underscore2.default.keys(this.collectionsMap),function(key){var collection=_this3.collectionsMap[key],changes=data[_this3.options.prefix+"."+key];_underscore2.default.each(changes,function(change){var model=collection.find(function(m){return m.entry.get("name")===change["@name"]});if(model){var obj=_jquery2.default.extend(!0,{},change);delete obj["@name"],model.entry.content.set(obj),deferreds.push(model.save({}))}else{var newModel=_this3.addNew(collection,change);deferreds.push(newModel.save({}))}});var currentNames=_underscore2.default.pluck(changes,"@name"),deletModels=collection.filter(function(model){return!_underscore2.default.contains(currentNames,model.entry.get("name"))});_underscore2.default.each(deletModels,function(model){deferreds.push(model.destroy())})}),deferreds}}],[{key:"getType",value:function(){return _ModSetupTypes.TYPES.SCRIPT}}]),ModSetupScriptType}(_ModSetupBaseType3.default);exports.default=ModSetupScriptType,module.exports=exports.default},"collections/modsetup/ModSetupScripts":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_ModSetupScript=__webpack_require__("models/modsetup/ModSetupScript"),_ModSetupScript2=_interopRequireDefault(_ModSetupScript),_SplunkDsBase=__webpack_require__("collections/SplunkDsBase"),_SplunkDsBase2=_interopRequireDefault(_SplunkDsBase);exports.default=_SplunkDsBase2.default.extend({model:_ModSetupScript2.default,url:function(){return _splunkd_utils2.default.fullpath(this.scriptUrl,{app:this.bundleId,owner:"nobody"})}}),module.exports=exports.default},"models/modsetup/ModSetupScript":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_SplunkDBase=__webpack_require__("models/SplunkDBase"),_SplunkDBase2=_interopRequireDefault(_SplunkDBase),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils);exports.default=_SplunkDBase2.default.extend({url:function(){var base="";return _splunkd_utils2.default.fullpath(base+this.scriptUrl,{app:this.bundleId,owner:"nobody"})},sync:function(method,model,options){var defaults={};switch(method){case"create":defaults={data:{output_mode:"json",name:this.entry.get("name")}}}var newOptions=_jquery2.default.extend({},defaults,options);return _SplunkDBase2.default.prototype.sync.call(this,method,model,newOptions)}}),module.exports=exports.default},"views/modsetup/ModSetup.pcss":function(module,exports,__webpack_require__){var content=__webpack_require__(1109);"string"==typeof content&&(content=[[module.id,content,""]]);__webpack_require__(14)(content,{});content.locals&&(module.exports=content.locals)},1109:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(),exports.push([module.id,'.content-body{max-height:560px;position:relative}.content-body .main-tabs{margin-bottom:2px;position:absolute;width:100%;top:0;z-index:1000}.content-body .main-tabs .icon-alert{color:#d6563c}.content-body .tab-content{padding:10px;padding-top:30px;overflow:auto;max-height:560px;border-top:.5px solid #dfdfdf}.content-body .tab-content .tab-pane{display:block;margin-left:25px;margin-top:10px}.content-body .control-group.error .mod-setup-error-message{color:#d6563c;font-size:10px}.content-body .icon-alert{font-size:100%;padding-left:10px}.bundle-name{margin-left:30px;margin-top:10px}.nav.nav-tabs-left{min-height:600px;width:300px;float:left;position:relative;border-right:.5px solid #dfdfdf;border-top:.5px solid #dfdfdf;overflow:auto}.nav.nav-tabs-left li{padding:10px 30px 10px 20px;position:relative;border-bottom:1px dotted #bfbfbf;text-overflow:ellipsis;font-size:14px;display:block;text-decoration:none!important}.nav.nav-tabs-left li a{text-decoration:none;text-overflow:ellipsis;display:inline-block;overflow:hidden;white-space:nowrap}.nav.nav-tabs-left li .icon-alert{font-size:100%;position:absolute;display:block;right:10%;top:8px;color:#d6563c}.nav.nav-tabs-left li:hover{background-color:rgba(0,0,0,.05)}.nav.nav-tabs-left li:hover a{background-color:transparent}.nav.nav-tabs-left li:focus{outline:none}.nav.nav-tabs-left li.active,.nav.nav-tabs-left li:focus{background-color:rgba(61,171,255,.12)}.nav.nav-tabs-left li.active a{color:#666}.nav.nav-tabs-left li.active:after{content:"\\203A";color:#bbb;font-size:24px;position:absolute;right:10px;top:0;line-height:33px;font-family:Splunk Icons}.nav.nav-tabs-left li>a:focus{box-shadow:none;background-color:transparent}.nav-tabs-left+.tab-content{margin-left:300px;height:600px}.app-name{font-weight:700}',""])},"views/modsetup/ModSetupAppsListDialog":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_backbone=__webpack_require__("require/backbone"),_backbone2=_interopRequireDefault(_backbone),_Modal=__webpack_require__("views/shared/Modal"),_Modal2=_interopRequireDefault(_Modal),_ControlGroup=__webpack_require__("views/shared/controls/ControlGroup"),_ControlGroup2=_interopRequireDefault(_ControlGroup),_splunk=__webpack_require__("shim/splunk.util"),_splunk2=_interopRequireDefault(_splunk);__webpack_require__("views/modsetup/ModSetupAppsListDialog.pcss"),exports.default=_Modal2.default.extend({initialize:function(options){_Modal2.default.prototype.initialize.apply(this,options);var appsWithSetup=this.model.appsModel.get("apps").filter(function(obj){return obj.hasSetup&&!obj.parentApp});this.model.list=new _backbone2.default.Model({apps:_underscore2.default.pluck(appsWithSetup,"value")}),this.children.list=new _ControlGroup2.default({label:(0,_underscore2.default)("Apps list").t(),controlType:"CheckboxGroup",controlOptions:{model:this.model.list,modelAttribute:"apps",items:appsWithSetup}})},events:{"click .btn-primary":"nextClicked"},nextClicked:function(e){var _this=this;e.preventDefault();var newApps=this.model.appsModel.get("apps").filter(function(item){return!(!_underscore2.default.contains(_this.model.list.get("apps"),item.value)&&!item.parentApp)});this.model.appsModel.set("apps",newApps),this.trigger("appsSelected"),this.hide()},getAppsWithoutSetup:function(){return _underscore2.default.pluck(this.model.appsModel.get("apps").filter(function(obj){return!obj.hasSetup}),"label")},render:function(){this.$el.html(_Modal2.default.TEMPLATE),this.$(_Modal2.default.HEADER_TITLE_SELECTOR).html(_underscore2.default.escape((0,_underscore2.default)("Select apps to configure").t())),this.$(_Modal2.default.BODY_SELECTOR).append(_Modal2.default.FORM_HORIZONTAL);var appStr=(0,_underscore2.default)('<span class="app-name">%s</span> requires the following dependencies. Select one or more of the following apps to configure them now.').t(),parentApp=this.model.appsModel.get("apps").find(function(item){return item.parentApp===!0}),listMessage=_splunk2.default.sprintf(appStr,parentApp.label),appsWithoutSetup=this.getAppsWithoutSetup();this.$(_Modal2.default.BODY_FORM_SELECTOR).html(this.compiledTemplate({message:listMessage,appsWithoutSetupList:appsWithoutSetup,missingSetupMessage:(0,_underscore2.default)("You cannot configure the following dependencies at this time. Check the App Listing page to see if any of the following apps need additional setup.").t()})),this.children.list.render().appendTo(this.$(".mod-setup-apps-list")),this.$(_Modal2.default.FOOTER_SELECTOR).append(_Modal2.default.BUTTON_NEXT),this.$("."+_Modal2.default.BUTTON_CLOSE_CLASS).remove()},template:'<%= message %><div class="mod-setup-apps-list"></div><% if (appsWithoutSetupList && appsWithoutSetupList.length > 0) { %><p> <%- missingSetupMessage %></p><ul class="modsetup-missing-setup-app"><% _.each(appsWithoutSetupList, function(app) { %><li> <%- app %></li><% });%></ul><% } %>'}),module.exports=exports.default},"views/modsetup/ModSetupAppsListDialog.pcss":function(module,exports,__webpack_require__){var content=__webpack_require__(1110);"string"==typeof content&&(content=[[module.id,content,""]]);__webpack_require__(14)(content,{});content.locals&&(module.exports=content.locals)},1110:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(),exports.push([module.id,".modsetup-missing-setup-app{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}",""])},"views/modsetup/Master.pcss":function(module,exports,__webpack_require__){var content=__webpack_require__(1111);"string"==typeof content&&(content=[[module.id,content,""]]);__webpack_require__(14)(content,{});content.locals&&(module.exports=content.locals)},1111:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(),exports.push([module.id,".main-section{background-color:#fff;min-height:600px}.wait-spinner{margin:5px}.success-section{margin-left:25px}.success-section .success-header{padding:10px}",""])},"helpers/modsetup/configuration/ModSetupConfigurationManager":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_ModSetupConfigurationHelper=__webpack_require__("helpers/modsetup/configuration/ModSetupConfigurationHelper"),_ModSetupConfigurationHelper2=_interopRequireDefault(_ModSetupConfigurationHelper),ModSetupConfigurationManager=function(){
function ModSetupConfigurationManager(options){(0,_classCallCheck3.default)(this,ModSetupConfigurationManager),this.options=options,this.configurations={},this.isEditAll=this.options.isEditAll||!1,this.mainApp=this.options.app,this.appsSetupDeferreds=[],this.appsFetchDeferred=_jquery2.default.Deferred()}return(0,_createClass3.default)(ModSetupConfigurationManager,[{key:"createConfiguration",value:function(app){return this.configurations[app]=new _ModSetupConfigurationHelper2.default({bundleId:app,isDMCEnabled:this.options.isDMCEnabled}),this.configurations[app]}},{key:"requiresSetup",value:function(){var configs=_underscore2.default.values(this.configurations);return configs.some(function(config){return config.hasSetup})}},{key:"checkDeferredsStatus",value:function(){var allAppsFetchResolved=!0;_underscore2.default.each(this.appsSetupDeferreds,function(deferred){"pending"===deferred.state()&&(allAppsFetchResolved=!1)}),allAppsFetchResolved&&this.appsFetchDeferred.resolve()}},{key:"fetchConfigAppsList",value:function(app){var _this=this,configuration=this.createConfiguration(app),deferred=configuration.getSetup();return this.appsSetupDeferreds.push(deferred),_jquery2.default.when(deferred).always(function(){var dependencies=configuration.dependencies;_underscore2.default.isEmpty(dependencies)||_underscore2.default.each(dependencies,function(dep){_this.fetchConfigAppsList(dep)}),_this.checkDeferredsStatus()}),this.appsFetchDeferred}},{key:"apps",get:function(){var _this2=this,appsList=[];return _underscore2.default.each(_underscore2.default.keys(this.configurations),function(name){_this2.configurations[name].getNeedsConfiguration(_this2.isEditAll)&&appsList.push({label:_this2.configurations[name].label,value:name,parentApp:_this2.mainApp===name,hasSetup:_this2.configurations[name].hasSetup})}),appsList}}]),ModSetupConfigurationManager}();exports.default=ModSetupConfigurationManager,module.exports=exports.default},"helpers/modsetup/configuration/ModSetupConfigurationHelper":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_AppDependenciesInfo=__webpack_require__("models/modsetup/AppDependenciesInfo"),_AppDependenciesInfo2=_interopRequireDefault(_AppDependenciesInfo),_ModSetupSplunkDConfs=__webpack_require__("collections/modsetup/ModSetupSplunkDConfs"),_ModSetupSplunkDConfs2=_interopRequireDefault(_ModSetupSplunkDConfs),_jquery=__webpack_require__("shim/jquery"),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_splunk=__webpack_require__("shim/splunk.util"),_splunk2=_interopRequireDefault(_splunk),_splunkd_utils=__webpack_require__("util/splunkd_utils"),_splunkd_utils2=_interopRequireDefault(_splunkd_utils),_ModSetupTypes=__webpack_require__("helpers/modsetup/managers/ModSetupTypes"),REQUIRED_CONF_PROPERTIES=["file","stanzas","properties"],ModSetupConfigurationHelper=function(){function ModSetupConfigurationHelper(options){(0,_classCallCheck3.default)(this,ModSetupConfigurationHelper),this.options=options}return(0,_createClass3.default)(ModSetupConfigurationHelper,[{key:"getSetup",value:function(){var _this=this,fetchDefered=_jquery2.default.Deferred(),deferreds=this.fetchConfiguration(),count=0;return _underscore2.default.each(deferreds,function(def){def.always(function(){_this.json&&_this.html&&(_this.hasSetup=!0),count+=1,count===deferreds.length&&fetchDefered.resolve()})}),fetchDefered}},{key:"fetchConfiguration",value:function(){var deferreds=[];if(this.options.isDMCEnabled)throw new Error("Not supported");var jsonUrl="/static/app/"+this.options.bundleId+"/setup.json";deferreds.push(this.fetchConfigJson(jsonUrl));var htmlUrl="/static/app/"+this.options.bundleId+"/setup.html";return deferreds.push(this.fetchConfigHtml(htmlUrl)),deferreds.push(this.fetchDependencies()),deferreds.push(this.fetchAppInfo()),deferreds}},{key:"fetchConfigJson",value:function(url){var _this2=this;return _jquery2.default.get(_splunkd_utils2.default.fullpath(url)).then(function(response){_this2.json=ModSetupConfigurationHelper.parseJson(response)})}},{key:"fetchConfigHtml",value:function(url){var _this3=this;return _jquery2.default.get(_splunkd_utils2.default.fullpath(url)).then(function(response){_this3.html=response})}},{key:"fetchDependencies",value:function(){var _this4=this,model=new _AppDependenciesInfo2.default;return model.set("bundleId",this.options.bundleId),model.fetch().then(function(){_this4.dependencies=_underscore2.default.filter(model.entry.content.keys(),function(key){return!/^eai:/i.test(key)})}).fail(function(){_this4.dependencies=[]})}},{key:"fetchAppInfo",value:function(){var _this5=this,stanzas=["ui","install"],config={file:"app",stanzas:stanzas,bundleId:this.options.bundleId,query:stanzas.map(function(x){return"name="+x}).join(" OR ")};return this.appCollection=new _ModSetupSplunkDConfs2.default,this.appCollection.config=config,this.appCollection.fetch().then(function(){_this5.isConfiguredModel=_this5.appCollection.find(function(m){return"install"===m.entry.get("name")}),_this5.appUiModel=_this5.appCollection.find(function(m){return"ui"===m.entry.get("name")})})}},{key:"getNeedsConfiguration",value:function(editMode){return!!editMode||!this.isConfigured}},{key:"isDMCEnabled",get:function(){return this.options.isDMCEnabled}},{key:"label",get:function(){return this.appUiModel.entry.content.get("label")}},{key:"isConfigured",get:function(){return _splunk2.default.normalizeBoolean(this.isConfiguredModel.entry.content.get("is_configured"))}}],[{key:"parseJson",value:function(config){try{var isValid=ModSetupConfigurationHelper.validateSetup(config.setup);return isValid?(_underscore2.default.each(config.setup,function(item){item.conf&&ModSetupConfigurationHelper.formatConf(item),item.types&&item.types.conf&&ModSetupConfigurationHelper.formatConf(item.types)}),config):null}catch(e){return window.console.log(e),null}}},{key:"formatConf",value:function(config){var item=config;item.conf&&!_underscore2.default.isArray(item.conf)&&(item.conf=[item.conf]),item.conf&&_underscore2.default.each(item.conf,function(c){var conf=c;conf.stanzas&&_underscore2.default.isString(conf.stanzas)&&(conf.stanzas=[conf.stanzas]),conf.properties&&!_underscore2.default.isArray(conf.properties)&&(conf.properties=[conf.properties])})}},{key:"validateSetup",value:function(setup){if(_underscore2.default.isEmpty(setup)||!_underscore2.default.isArray(setup))throw new Error("No setup configuration provided");return _underscore2.default.each(setup,function(config){var matchedType=_underscore2.default.intersection(_underscore2.default.keys(config),_underscore2.default.values(_ModSetupTypes.TYPES));if(1!==matchedType.length)throw new Error("Invalid Config type "+JSON.stringify(config));if("conf"===matchedType[0]&&(_underscore2.default.isArray(config.conf)?_underscore2.default.each(config.conf,function(conf){ModSetupConfigurationHelper.validateConf(conf)}):ModSetupConfigurationHelper.validateConf(config.conf)),"password"===matchedType[0]&&_underscore2.default.isEmpty(config.password.key))throw new Error("Invalid Password configuration : "+JSON.stringify(config));if("script"===matchedType[0]&&_underscore2.default.isEmpty(config.script.url))throw new Error("Invalid script configuration "+JSON.stringify(config))}),!0}},{key:"validateConf",value:function(config){var keys=_underscore2.default.keys(config),hasAllProperties=REQUIRED_CONF_PROPERTIES.every(function(item){return keys.indexOf(item)>-1&&!_underscore2.default.isEmpty(config[item])});if(!hasAllProperties)throw new Error("Conf does not have all required properties\n             ("+REQUIRED_CONF_PROPERTIES.join(",")+") : "+JSON.stringify(config))}}]),ModSetupConfigurationHelper}();exports.default=ModSetupConfigurationHelper,module.exports=exports.default},"helpers/modsetup/managers/ModSetupPasswordType":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(22),Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck2=__webpack_require__(617),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(618),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(830),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(876),_inherits3=_interopRequireDefault(_inherits2),_ModSetupPassword=__webpack_require__("models/modsetup/ModSetupPassword"),_ModSetupPassword2=_interopRequireDefault(_ModSetupPassword),_underscore=__webpack_require__("require/underscore"),_underscore2=_interopRequireDefault(_underscore),_ModSetupBaseType2=__webpack_require__("helpers/modsetup/managers/ModSetupBaseType"),_ModSetupBaseType3=_interopRequireDefault(_ModSetupBaseType2),_ModSetupTypes=__webpack_require__("helpers/modsetup/managers/ModSetupTypes"),ModSetupPasswordType=function(_ModSetupBaseType){function ModSetupPasswordType(){return(0,_classCallCheck3.default)(this,ModSetupPasswordType),(0,_possibleConstructorReturn3.default)(this,(ModSetupPasswordType.__proto__||Object.getPrototypeOf(ModSetupPasswordType)).apply(this,arguments))}return(0,_inherits3.default)(ModSetupPasswordType,_ModSetupBaseType),(0,_createClass3.default)(ModSetupPasswordType,[{key:"getDefaultValues",value:function(){var _this2=this,defaults={};return _underscore2.default.each(this.models,function(model){var clrPassword=model.entry.content.get("clear_password");if(clrPassword){var data=JSON.parse(clrPassword);_underscore2.default.each(_underscore2.default.keys(data),function(key){defaults[_this2.options.prefix+"."+key]=data[key]})}}),defaults}},{key:"create",value:function(config){var deferreds=[],model=new _ModSetupPassword2.default;return model.set({name:config.name,fields:config.password.fields,bundle:this.options.bundleId}),model.entry.set({name:config.password.key}),this.models.push(model),deferreds.push(model.fetch()),deferreds}},{key:"save",value:function(d){var _this3=this,data=d,deferreds=[];return _underscore2.default.each(this.models,function(model){var passKey={};_underscore2.default.each(model.get("fields"),function(field){passKey[field]=data[_this3.options.prefix+"."+field]});var obj={name:model.get("key"),password:JSON.stringify(passKey)};model.entry.content.clear(),model.entry.content.set(obj),deferreds.push(model.save({}))}),deferreds}}],[{key:"getType",value:function(){return _ModSetupTypes.TYPES.PASSWORD}}]),ModSetupPasswordType}(_ModSetupBaseType3.default);exports.default=ModSetupPasswordType,module.exports=exports.default}});