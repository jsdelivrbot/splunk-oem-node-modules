<%inherit file="/layout/message.html" />
<%!
title = 'SSO Configuration'
%>
<%def name="header()">
    <h1>Splunk SSO configuration summary</h1>
</%def>

<style type="text/css">
    .masterContainer { background-color: #fff;}
    table { width: 100%; }
    td.k { width: 150px; }
</style>

<h2>SSO settings</h2>
<table>
    <tr>
        <td class="k">SSO Enabled</td>
        <td class="v splFont-mono">${sso_enabled | h}</td>
    </tr>
    <tr>
        <td class="k">splunkd trustedIP</td>
        <td class="v splFont-mono">${splunkd_trusted_ip | h}</td>
    </tr>
    <tr>
        <td class="k">splunkweb trustedIP</td>
        <td class="v splFont-mono">${splunkweb_trusted_ip | h}</td>
    </tr>
    <tr>
        <td class="k">splunkweb SSO Mode</td>
        <td class="v splFont-mono">${sso_mode | h}</td>
    </tr>
</table>

<h2>Splunkweb settings</h2>
<table>
    <tbody>
    <tr>
        <td class="k">Host Name</td>
        <td class="v splFont-mono">${host_name | h}</td>
    </tr>
    <tr>
        <td class="k">Host IP</td>
        <td class="v splFont-mono">${host_ip | h}</td>
    </tr>
    <tr>
        <td class="k">Port</td>
        <td class="v splFont-mono">${port | h}</td>
    </tr>
	<tr>
		<td class="k">Incoming request IP received by splunkweb</td>
	    <td class="v splFont-mono">${splunkweb_remote_ip | h}</td>
	</tr>
	<tr>
		<td class="k">Is the incoming request IP in splunkweb's list of trustedIPs?</td>
	    <td class="v splFont-mono">${splunkweb_trusted_ip_matches | h}</td>
	</tr>
    </tbody>
</table>

<h2>Remote user HTTP header</h2>
<table>
	<tr>
		<td class="k">Remote User HTTP Header</td>
	    <td class="v splFont-mono">${remote_user_header_name | h}</td>
	</tr>
    <tr>
        <td class="k">Value of ${remote_user_header_name | h}</td>
        <td class="v splFont-mono">${remote_user | h}</td>
    </tr>
</table>

<h2>Other HTTP headers</h2>
<table>
    % for header in sorted(headers):
        % if 'Cookie' not in header:
            <tr>
                <td class="k">${header | h}</td>
                <td class="v splFont-mono">${headers.get(header) | h}</td>
            </tr>
        % endif
    % endfor
</table>
